<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image Stitching</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-3">
    <h1>Image Stitching</h1>
    <form id="image-form" method="POST">
      <div class="mb-3">
        <label for="dataset" class="form-label">Select Dataset:</label>
        <select name="dataset" id="dataset" class="form-control">
          </select>
      </div>
      <button type="submit" class="btn btn-primary">Processing images</button>
    </form>
  </div>
  <script>
    const datasets = {{ datasets|tojson }};
    const datasetSelect = document.getElementById('dataset');

    datasets.forEach(dataset => {
      const option = document.createElement('option');
      option.value = dataset;
      option.textContent = dataset;
      datasetSelect.appendChild(option);
    });

    // const form = document.getElementById('image-form');
    // const result = document.getElementById('result');  // Add a result div (optional)

    // form.addEventListener('submit', async (event) => {
    //   event.preventDefault();
    //   const dataset = form.elements.dataset.value;

    //   // Show loading indicator (unchanged)
    //   result.textContent = "Stitching and overlaying images...";  // Update message
    //   const loadingSpinner = document.createElement('div');
    //   loadingSpinner.classList.add('spinner-border');
    //   loadingSpinner.classList.add('text-primary');
    //   result.appendChild(loadingSpinner);

    //   // Submit form data (unchanged)
    //   const formData = new FormData();
    //   formData.append('dataset', dataset);
    //   // ... (rest of form submission logic)

    //   // Clear loading indicator and handle response (updated)
    //   const response = await fetch('/process-image', {
    //     method: 'POST',
    //     body: formData,
    //   });

    //   if (response.status === 200) {  // Check for successful response
    //     const downloadLink = document.createElement('a');
    //     downloadLink.href = response.url;
    //     downloadLink.download = "stitched_and_overlaid.jpg";  // Set download filename
    //     downloadLink.textContent = "Download Processed Image";
    //     result.textContent = "";  // Clear loading message
    //     result.appendChild(downloadLink);
    //     loadingSpinner.remove();  // Remove spinner
    //   } else {
    //     // Handle error (unchanged)
    //     const error_message = await response.text();
    //     result.textContent = error_message;
    //     loadingSpinner.remove();
    //   }
    // });
  </script>
</body>
</html>

